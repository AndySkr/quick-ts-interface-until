/** @format */

"use strict";

var _regeneratorRuntime = require("@babel/runtime/regenerator");

var _asyncToGenerator = require("@babel/runtime/helpers/asyncToGenerator");

var _require = require("quicktype-core"),
  t = _require.quicktype,
  e = _require.InputData,
  n = _require.JSONInput,
  o = _require.jsonInputForTargetLanguage,
  s = require("fs"),
  c = require("axios"),
  r = require("chalk");

var a = {};

module.exports = /*#__PURE__*/ (function () {
  var _ref = _asyncToGenerator(
    /*#__PURE__*/ _regeneratorRuntime.mark(function _callee2(n) {
      var _yield, _n, _c;

      return _regeneratorRuntime.wrap(
        function _callee2$(_context2) {
          while (1) {
            switch ((_context2.prev = _context2.next)) {
              case 0:
                _context2.prev = 0;
                _context2.next = 3;
                return (function (t) {
                  return new Promise(function (e, n) {
                    c.post(t)
                      .then(function (t) {
                        var _t$data;

                        var n =
                          (_t$data = t.data) === null || _t$data === void 0
                            ? void 0
                            : _t$data.responseVo;
                        (a = n), e(n);
                      })
                      ["catch"](function (t) {
                        console.log(t), n(t);
                      });
                  });
                })(n);

              case 3:
                _context2.next = 8;
                break;

              case 5:
                _context2.prev = 5;
                _context2.t0 = _context2["catch"](0);
                console.log(_context2.t0);

              case 8:
                _context2.prev = 8;
                _context2.next = 11;
                return (function () {
                  var _ref2 = _asyncToGenerator(
                    /*#__PURE__*/ _regeneratorRuntime.mark(function _callee(
                      n,
                      s
                    ) {
                      var c, r;
                      return _regeneratorRuntime.wrap(function _callee$(
                        _context
                      ) {
                        while (1) {
                          switch ((_context.prev = _context.next)) {
                            case 0:
                              c = o("typescript");
                              _context.next = 3;
                              return c.addSource({
                                name: n,
                                samples: [s],
                              });

                            case 3:
                              r = new e();
                              r.addInput(c);
                              _context.next = 7;
                              return t({
                                inputData: r,
                                lang: "typescript",
                                rendererOptions: {
                                  "just-types": !0,
                                },
                              });

                            case 7:
                              return _context.abrupt("return", _context.sent);

                            case 8:
                            case "end":
                              return _context.stop();
                          }
                        }
                      },
                      _callee);
                    })
                  );

                  return function (_x2, _x3) {
                    return _ref2.apply(this, arguments);
                  };
                })()("Book", JSON.stringify(a));

              case 11:
                _yield = _context2.sent;
                _n = _yield.lines;
                _c = _n === null || _n === void 0 ? void 0 : _n.join("\n");
                s.writeFile("type.d.ts", _c, function (t) {
                  if (t) throw t;
                  console.log(
                    r.keyword("orange")(
                      "==>==>==>==>==> * * * * * Successful! * * * * * <==<==<==<==<=="
                    )
                  );
                });
                _context2.next = 20;
                break;

              case 17:
                _context2.prev = 17;
                _context2.t1 = _context2["catch"](8);
                console.log(_context2.t1);

              case 20:
              case "end":
                return _context2.stop();
            }
          }
        },
        _callee2,
        null,
        [
          [0, 5],
          [8, 17],
        ]
      );
    })
  );

  return function (_x) {
    return _ref.apply(this, arguments);
  };
})();
